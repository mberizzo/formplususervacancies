{% put scripts %}
<script>
    new Vue({
        el: '#curriculum',
        data: {
            form_data: {{ formData.data|json_encode|raw }},
        },
        mounted() {
            let input = document.createElement('input');
            let domForm = document.forms["{{ this.page.renderForm['formCode'] }}"];
            input.setAttribute('type', 'hidden');
            input.setAttribute('name', 'is_curriculum');
            input.setAttribute('value', 'true');
            domForm.appendChild(input);
        },
    });

    {% if (formData.files.count) %}
        $(function() {
            var mockFile = {};
            var myDropzone = $('[data-control=multi-file-uploader]').get(0).dropzone;
            {% for key, file in formData.files %}
                mockFile[{{ key }}] = {
                    id: '{{ file.id }}',
                    name: '{{ file.file_name }}',
                    size: '{{ file.file_size }}',
                    path: '{{ file.getLocalPath }}',
                    thumb: '{{ file.path }}',
                };
                myDropzone.options.addedfile.call(myDropzone, mockFile[{{ key }}]);
                myDropzone.options.thumbnail.call(myDropzone, mockFile[{{ key }}], '{{ file.path }}');
                myDropzone.emit("success", mockFile[{{ key }}], mockFile[{{ key }}]);
            {% endfor %}
        })
    {% endif %}
</script>
{% endput %}
